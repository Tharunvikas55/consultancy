<!DOCTYPE html>
<html lang="en">
  <%- include("./partials/Header.ejs") %> <%- include("./partials/Link.ejs") %>
  <body>
    <section style="background-color: #e3f2fd">
      <div class="container h-100">
        <div class="row d-flex justify-content-center align-items-center h-100">
          <div class="col-lg-10 col-xl-9">
            <div class="card text-black" style="border-radius: 25px">
              <div class="card-body p-md-5">
                <div class="row justify-content-center">
                  <div class="col-md-8 col-lg-6 col-xl-5 order-2 order-lg-1">
                    <p class="text-center h1 fw-bold mb-5 mx-1 mx-md-4 mt-4">
                      Sign up
                    </p>

                    <!-- Display Error Message -->
                    <div
                      id="errorMessageContainer"
                      class="alert alert-danger"
                      role="alert"
                      style="display: none"
                    ></div>

                    <form
                      action="/api/v1/signup"
                      method="post"
                      class="mx-1 mx-md-4"
                      id="signupForm"
                    >
                      <!-- Name Field -->
                      <div class="d-flex flex-row align-items-center mb-4">
                        <i class="fas fa-user fa-lg me-3 fa-fw"></i>
                        <div
                          class="form-floating mb-3 form-outline flex-fill mb-0"
                        >
                          <input
                            type="text"
                            name="customerName"
                            id="customerName"
                            pattern="[A-Za-z\s]{2,}"
                            placeholder="Name"
                            class="form-control"
                            required
                          />
                          <label for="customerName">Name</label>
                          <span class="text-danger" id="nameError"></span>
                        </div>
                      </div>

                      <!-- Email Field -->
                      <div class="d-flex flex-row align-items-center mb-4">
                        <i class="fas fa-envelope fa-lg me-3 fa-fw"></i>
                        <div class="form-floating form-outline flex-fill mb-0">
                          <input
                            type="email"
                            id="email"
                            class="form-control"
                            placeholder="Your Email"
                            name="email"
                            required
                          />
                          <label for="email">Email</label>
                          <span class="text-danger" id="emailError"></span>
                        </div>
                      </div>

                      <!-- Password Field -->
                      <div class="d-flex flex-row align-items-center mb-4">
                        <i class="fas fa-lock fa-lg me-3 fa-fw"></i>
                        <div class="form-floating form-outline flex-fill mb-0">
                          <input
                            type="password"
                            id="password"
                            class="form-control"
                            pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,15}"
                            placeholder="Password"
                            required
                          />
                          <label for="password">Password</label>
                          <span class="text-danger" id="passwordError"></span>
                        </div>
                      </div>

                      <!-- Confirm Password Field -->
                      <div class="d-flex flex-row align-items-center mb-4">
                        <i class="fas fa-key fa-lg me-3 fa-fw"></i>
                        <div class="form-floating form-outline flex-fill mb-0">
                          <input
                            type="password"
                            id="confirmPassword"
                            class="form-control"
                            placeholder="Repeat your password"
                            required
                          />
                          <label for="confirmPassword"
                            >Repeat your password</label
                          >
                          <span
                            class="text-danger"
                            id="confirmPasswordError"
                          ></span>
                        </div>
                      </div>

                      <!-- Mobile Number Field -->
                      <div class="d-flex flex-row align-items-center mb-4">
                        <i class="fas fa-user fa-lg me-3 fa-fw"></i>
                        <div
                          class="form-floating mb-3 form-outline flex-fill mb-0"
                        >
                          <input
                            type="text"
                            id="mobileNumber"
                            class="form-control"
                            name="customerMobileNumber"
                            placeholder="Mobile no"
                            pattern="[0-9]{10}"
                            required
                          />
                          <label for="mobileNumber">Mobile Number</label>
                          <span
                            class="text-danger"
                            id="mobileNumberError"
                          ></span>
                        </div>
                      </div>

                      <!-- Door Number Field -->
                      <div class="d-flex flex-row align-items-center mb-4">
                        <i class="fas fa-user fa-lg me-3 fa-fw"></i>
                        <div
                          class="form-floating mb-3 form-outline flex-fill mb-0"
                        >
                          <input
                            type="text"
                            id="doorNumber"
                            class="form-control"
                            name="doorNumber"
                            placeholder="Door Number with street name"
                            required
                          />
                          <label for="doorNumber"
                            >Door Number with street name</label
                          >
                          <span class="text-danger" id="doorNumberError"></span>
                        </div>
                      </div>

                      <!-- City Field -->
                      <div class="d-flex flex-row align-items-center mb-4">
                        <i class="fas fa-user fa-lg me-3 fa-fw"></i>
                        <div
                          class="form-floating mb-3 form-outline flex-fill mb-0"
                        >
                          <input
                            type="text"
                            id="city"
                            class="form-control"
                            name="city"
                            placeholder="City"
                            required
                          />
                          <label for="city">City</label>
                          <span class="text-danger" id="cityError"></span>
                        </div>
                      </div>

                      <!-- Pincode Field -->
                      <div class="d-flex flex-row align-items-center mb-4">
                        <i class="fas fa-code fa-lg me-3 fa-fw"></i>
                        <div
                          class="form-floating mb-3 form-outline flex-fill mb-0"
                        >
                          <input
                            type="text"
                            name="pincode"
                            id="pincode"
                            class="form-control"
                            placeholder="Pincode"
                            pattern="[0-9]{6}"
                            required
                          />
                          <label for="pincode">Pincode</label>
                          <span class="text-danger" id="pincodeError"></span>
                        </div>
                      </div>

                      <!-- District Field -->
                      <div class="d-flex flex-row align-items-center mb-4">
                        <i class="fas fa-map-marker fa-lg me-3 fa-fw"></i>
                        <div
                          class="form-floating mb-3 form-outline flex-fill mb-0"
                        >
                          <input
                            type="text"
                            name="district"
                            id="district"
                            class="form-control"
                            placeholder="District"
                            readonly
                          />
                          <label for="district">District</label>
                        </div>
                      </div>

                      <!-- State Field -->
                      <div class="d-flex flex-row align-items-center mb-4">
                        <i class="fas fa-map fa-lg me-3 fa-fw"></i>
                        <div
                          class="form-floating mb-3 form-outline flex-fill mb-0"
                        >
                          <input
                            type="text"
                            name="state"
                            id="state"
                            class="form-control"
                            placeholder="State"
                            readonly
                          />
                          <label for="state">State</label>
                        </div>
                      </div>

                      <!-- Terms and Conditions -->
                      <div
                        class="form-check d-flex justify-content-center mb-5"
                      >
                        <input
                          class="form-check-input me-2"
                          type="checkbox"
                          id="termsCheck"
                          required
                        />
                        <label class="form-check-label" for="termsCheck">
                          I agree all statements in
                          <a href="">Terms of service</a>
                        </label>
                      </div>

                      <!-- Existing Account -->
                      <div
                        class="form-check d-flex justify-content-center mb-5"
                      >
                        <label class="form-check-label">
                          Already have an account?
                          <a href="/api/v1/login" class="link-secondary"
                            >Login</a
                          >
                        </label>
                      </div>

                      <!-- Submit Button -->
                      <div
                        class="d-flex justify-content-center mx-4 mb-3 mb-lg-4"
                      >
                        <button
                          type="submit"
                          data-mdb-button-init
                          data-mdb-ripple-init
                          class="btn btn-primary btn-lg"
                        >
                          Register
                        </button>
                      </div>
                    </form>
                  </div>
                  <div
                    class="col-md-10 col-lg-6 col-xl-7 d-flex align-items-center order-1 order-lg-2"
                  >
                    <img
                      src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-registration/draw1.webp"
                      class="img-fluid"
                      alt="Sample image"
                    />
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <script>
      document
        .getElementById("signupForm")
        .addEventListener("submit", function (event) {
          // Clear all error messages
          document
            .querySelectorAll("span.text-danger")
            .forEach((el) => (el.textContent = ""));
          document.getElementById("errorMessageContainer").style.display =
            "none";

          let valid = true;

          // Validate Name
          const name = document.getElementById("customerName");
          if (!name.checkValidity()) {
            valid = false;
            document.getElementById("nameError").textContent =
              "Please enter a valid name with at least 2 characters.";
          }

          // Validate Email
          const email = document.getElementById("email");
          if (!email.checkValidity()) {
            valid = false;
            document.getElementById("emailError").textContent =
              "Please enter a valid email address.";
          }

          // Validate Password
          const password = document.getElementById("password");
          if (!password.checkValidity()) {
            valid = false;
            document.getElementById("passwordError").textContent =
              "Password must be between 8 and 15 characters, and include at least one number, one uppercase, and one lowercase letter.";
          }

          // Validate Confirm Password
          const confirmPassword = document.getElementById("confirmPassword");
          if (password.value !== confirmPassword.value) {
            valid = false;
            document.getElementById("confirmPasswordError").textContent =
              "Passwords do not match.";
          }

          // Validate Mobile Number
          const mobileNumber = document.getElementById("mobileNumber");
          if (!mobileNumber.checkValidity()) {
            valid = false;
            document.getElementById("mobileNumberError").textContent =
              "Please enter a valid 10-digit mobile number.";
          }

          // Validate Address
          const address = document.getElementById("address");
          if (!address.checkValidity()) {
            valid = false;
            document.getElementById("addressError").textContent =
              "Please enter a valid address.";
          }

          // Validate Door Number
          const doorNumber = document.getElementById("doorNumber");
          if (!doorNumber.checkValidity()) {
            valid = false;
            document.getElementById("doorNumberError").textContent =
              "Please enter a valid door number.";
          }

          // Validate City
          const city = document.getElementById("city");
          if (!city.checkValidity()) {
            valid = false;
            document.getElementById("cityError").textContent =
              "Please enter a valid city name.";
          }

          // Validate Pincode
          const pincode = document.getElementById("pincode");
          if (!pincode.checkValidity()) {
            valid = false;
            document.getElementById("pincodeError").textContent =
              "Please enter a valid 6-digit pincode.";
          }

          // Fetch district and state based on pincode
          if (pincode.value.length === 6) {
            fetch(
              `https://api.example.com/getLocation?pincode=${pincode.value}`
            )
              .then((response) => response.json())
              .then((data) => {
                document.getElementById("district").value = data.district || "";
                document.getElementById("state").value = data.state || "";
              });
          }

          // Prevent form submission if any validation fails
          if (!valid) {
            event.preventDefault();
            document.getElementById("errorMessageContainer").style.display =
              "block";
          }
        });
    </script>
  </body>
</html>
